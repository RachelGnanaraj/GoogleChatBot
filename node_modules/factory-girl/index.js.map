{"version":3,"file":"index.js","sources":["../src/utils/asyncPopulate.js","../src/Factory.js","../src/generators/Generator.js","../src/generators/Sequence.js","../src/generators/Assoc.js","../src/generators/AssocAttrs.js","../src/generators/AssocMany.js","../src/generators/AssocAttrsMany.js","../src/generators/ChanceGenerator.js","../src/generators/OneOf.js","../src/adapters/DefaultAdapter.js","../src/FactoryGirl.js","../src/adapters/ObjectAdapter.js","../src/adapters/BookshelfAdapter.js","../src/adapters/MongooseAdapter.js","../src/adapters/SequelizeAdapter.js","../src/adapters/ReduxORMAdapter.js","../src/index.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\nexport default function asyncPopulate(target, source) {\n  if (typeof target !== 'object') {\n    return Promise.reject(new Error('Invalid target passed'));\n  }\n  if (typeof source !== 'object') {\n    return Promise.reject(new Error('Invalid source passed'));\n  }\n\n  const promises = Object.keys(source).map(attr => {\n    let promise;\n    if (Array.isArray(source[attr])) {\n      target[attr] = [];\n      promise = asyncPopulate(target[attr], source[attr]);\n    } else if (source[attr] === null) {\n      target[attr] = null;\n    } else if (typeof source[attr] === 'object' && !source[attr]._bsontype) {\n      target[attr] = target[attr] || {};\n      promise = asyncPopulate(target[attr], source[attr]);\n    } else if (typeof source[attr] === 'function') {\n      promise = Promise.resolve(source[attr]()).then(v => { target[attr] = v; });\n    } else {\n      promise = Promise.resolve(source[attr]).then(v => { target[attr] = v; });\n    }\n    return promise;\n  });\n  return Promise.all(promises);\n}\n/* eslint-enable no-underscore-dangle */\n","\nimport asyncPopulate from './utils/asyncPopulate';\n\nexport default class Factory {\n  name = null;\n  Model = null;\n  initializer = null;\n  options = {};\n\n  constructor(Model, initializer, options = {}) {\n    if (!Model) {\n      throw new Error('Invalid Model constructor passed to the factory');\n    }\n    if ((typeof initializer !== 'object' && typeof initializer !== 'function') ||\n        !initializer) {\n      throw new Error('Invalid initializer passed to the factory');\n    }\n\n    this.Model = Model;\n    this.initializer = initializer;\n    this.options = { ...this.options, ...options };\n  }\n\n  getFactoryAttrs(buildOptions = {}) {\n    let attrs;\n    if (typeof this.initializer === 'function') {\n      attrs = this.initializer(buildOptions);\n    } else {\n      attrs = { ...this.initializer };\n    }\n    return Promise.resolve(attrs);\n  }\n\n  async attrs(extraAttrs = {}, buildOptions = {}) {\n    const factoryAttrs = await this.getFactoryAttrs(buildOptions);\n    const modelAttrs = {};\n\n    const filteredAttrs = Object.keys(factoryAttrs).reduce((attrs, name) => {\n      if (!extraAttrs.hasOwnProperty(name)) attrs[name] = factoryAttrs[name];\n      return attrs;\n    }, {});\n\n    await asyncPopulate(modelAttrs, filteredAttrs);\n    await asyncPopulate(modelAttrs, extraAttrs);\n\n    return modelAttrs;\n  }\n\n  async build(adapter, extraAttrs = {}, buildOptions = {}) {\n    const modelAttrs = await this.attrs(extraAttrs, buildOptions);\n    const model = adapter.build(this.Model, modelAttrs);\n    return this.options.afterBuild ?\n        this.options.afterBuild(model, extraAttrs, buildOptions) :\n        model;\n  }\n\n  async create(adapter, attrs = {}, buildOptions = {}) {\n    const model = await this.build(adapter, attrs, buildOptions);\n    return adapter.save(model, this.Model)\n      .then(savedModel => (this.options.afterCreate ?\n          this.options.afterCreate(savedModel, attrs, buildOptions) :\n          savedModel\n      ));\n  }\n\n  attrsMany(num, attrsArray = [], buildOptionsArray = []) {\n    let attrObject = null;\n    let buildOptionsObject = null;\n\n    if (typeof attrsArray === 'object' && !Array.isArray(attrsArray)) {\n      attrObject = attrsArray;\n      attrsArray = [];\n    }\n    if (typeof buildOptionsArray === 'object' && !Array.isArray(buildOptionsArray)) {\n      buildOptionsObject = buildOptionsArray;\n      buildOptionsArray = [];\n    }\n    if (typeof num !== 'number' || num < 1) {\n      return Promise.reject(new Error('Invalid number of objects requested'));\n    }\n    if (!Array.isArray(attrsArray)) {\n      return Promise.reject(new Error('Invalid attrsArray passed'));\n    }\n    if (!Array.isArray(buildOptionsArray)) {\n      return Promise.reject(new Error('Invalid buildOptionsArray passed'));\n    }\n    attrsArray.length = buildOptionsArray.length = num;\n    const models = [];\n    for (let i = 0; i < num; i++) {\n      models[i] = this.attrs(\n        attrObject || attrsArray[i] || {},\n        buildOptionsObject || buildOptionsArray[i] || {}\n      );\n    }\n    return Promise.all(models);\n  }\n\n  async buildMany(adapter, num, attrsArray = [], buildOptionsArray = [],\n      buildCallbacks = true) {\n    const attrs = await this.attrsMany(num, attrsArray, buildOptionsArray);\n    const models = attrs.map(attr => adapter.build(this.Model, attr));\n    return Promise.all(models)\n      .then(builtModels => (this.options.afterBuild && buildCallbacks ?\n          Promise.all(builtModels.map(builtModel => this.options.afterBuild(\n            builtModel, attrsArray, buildOptionsArray\n          ))) :\n          builtModels\n      ));\n  }\n\n  async createMany(adapter, num, attrsArray = [], buildOptionsArray = []) {\n    const models = await this.buildMany(\n      adapter, num, attrsArray, buildOptionsArray\n    );\n    const savedModels = models.map(model => adapter.save(model, this.Model));\n    return Promise.all(savedModels)\n      .then(createdModels => (this.options.afterCreate ?\n          Promise.all(createdModels.map(createdModel => this.options.afterCreate(\n            createdModel, attrsArray, buildOptionsArray\n          ))) :\n          createdModels\n      ));\n  }\n}\n","\nexport default class Generator {\n  constructor(factoryGirl) {\n    if (!factoryGirl) {\n      throw new Error('No FactoryGirl instance provided');\n    }\n    this.factoryGirl = factoryGirl;\n  }\n\n  generate() {\n    throw new Error('Override this method to generate a value');\n  }\n\n  getAttribute(name, model, key) {\n    return this.factoryGirl.getAdapter(name).get(model, key);\n  }\n}\n","\nimport Generator from './Generator';\n\nexport default class Sequence extends Generator {\n  static sequences = {};\n\n  static reset(id = null) {\n    if (!id) {\n      Sequence.sequences = {};\n    } else {\n      Sequence.sequences[id] = undefined;\n    }\n  }\n\n  generate(id = null, callback = null) {\n    if (typeof id === 'function') {\n      callback = id;\n      id = null;\n    }\n    id = id || this.id || (this.id = generateId());\n    Sequence.sequences[id] = Sequence.sequences[id] || 1;\n    const next = Sequence.sequences[id]++;\n    return callback ? callback(next) : next;\n  }\n}\n\nfunction generateId() {\n  let id;\n  let i = 0;\n  do {\n    id = `_${i++}`;\n  } while (id in Sequence.sequences);\n  return id;\n}\n","\nimport Generator from './Generator';\n\nexport default class Assoc extends Generator {\n  async generate(name, key = null, attrs = {}, buildOptions = {}) {\n    const model = await this.factoryGirl.create(name, attrs, buildOptions);\n    return key ? this.getAttribute(name, model, key) : model;\n  }\n}\n","\nimport Generator from './Generator';\n\nexport default class AssocAttrs extends Generator {\n  async generate(name, key = null, attrs = {}, buildOptions = {}) {\n    const model = await this.factoryGirl.attrs(name, attrs, buildOptions);\n    return key ? this.getAttribute(name, model, key) : model;\n  }\n}\n","\nimport Generator from './Generator';\n\nexport default class AssocMany extends Generator {\n  async generate(name, num, key = null, attrs = {}, buildOptions = {}) {\n    const models = await this.factoryGirl.createMany(name, num, attrs, buildOptions);\n    return key ? models.map(model => this.getAttribute(name, model, key)) : models;\n  }\n}\n","\n\nimport Generator from './Generator';\n\nexport default class AssocAttrsMany extends Generator {\n  async generate(name, num, key = null, attrs = {}, buildOptions = {}) {\n    if (typeof num !== 'number' || num < 1) {\n      throw new Error('Invalid number of items requested');\n    }\n    const models = await this.factoryGirl.attrsMany(name, num, attrs, buildOptions);\n    return key ? models.map(model => this.getAttribute(name, model, key)) : models;\n  }\n}\n","\nimport Generator from './Generator';\nimport Chance from 'chance';\n\nconst chance = new Chance();\n\nexport default class ChanceGenerator extends Generator {\n  generate(chanceMethod, options) {\n    if (typeof chance[chanceMethod] !== 'function') {\n      throw new Error('Invalid chance method requested');\n    }\n    return chance[chanceMethod](options);\n  }\n}\n","\nimport Generator from './Generator';\n\nexport default class OneOf extends Generator {\n  async generate(possibleValues) {\n    if (!Array.isArray(possibleValues)) {\n      throw new Error('Expected an array of possible values');\n    }\n\n    if (possibleValues.length < 1) {\n      throw new Error('Empty array passed for possible values');\n    }\n\n    const size = possibleValues.length;\n    const randomIndex = Math.floor(Math.random() * size);\n    const value = possibleValues[randomIndex];\n    return (typeof value === 'function') ? value() : value;\n  }\n}\n","/* eslint-disable no-unused-vars */\nexport default class DefaultAdapter {\n  build(Model, props) {\n    return new Model(props);\n  }\n  async save(model, Model) {\n    return Promise.resolve(model.save()).then(() => model);\n  }\n  async destroy(model, Model) {\n    return Promise.resolve(model.destroy()).then(() => model);\n  }\n  get(model, attr, Model) {\n    return model.get(attr);\n  }\n  set(props, model, Model) {\n    return model.set(props);\n  }\n}\n","import Factory from './Factory';\nimport Sequence from './generators/Sequence';\nimport Assoc from './generators/Assoc';\nimport AssocAttrs from './generators/AssocAttrs';\nimport AssocMany from './generators/AssocMany';\nimport AssocAttrsMany from './generators/AssocAttrsMany';\nimport ChanceGenerator from './generators/ChanceGenerator';\nimport OneOf from './generators/OneOf';\nimport DefaultAdapter from './adapters/DefaultAdapter';\n\nexport default class FactoryGirl {\n  factories = {};\n  options = {};\n  adapters = {};\n  created = new Set();\n\n  constructor(options = {}) {\n    this.assoc = generatorThunk(this, Assoc);\n    this.assocMany = generatorThunk(this, AssocMany);\n    this.assocBuild = deprecate('assocBuild', 'assocAttrs');\n    this.assocBuildMany = deprecate('assocBuildMany', 'assocAttrsMany');\n    this.assocAttrs = generatorThunk(this, AssocAttrs);\n    this.assocAttrsMany = generatorThunk(this, AssocAttrsMany);\n    this.seq = this.sequence =\n      (...args) => generatorThunk(this, Sequence)(...args);\n    this.resetSeq = this.resetSequence = id => { Sequence.reset(id); };\n    this.chance = generatorThunk(this, ChanceGenerator);\n    this.oneOf = generatorThunk(this, OneOf);\n\n    this.defaultAdapter = new DefaultAdapter;\n    this.options = options;\n  }\n\n  define(name, Model, initializer, options) {\n    if (this.getFactory(name, false)) {\n      throw new Error(`Factory ${name} already defined`);\n    }\n    this.factories[name] = new Factory(Model, initializer, options);\n  }\n\n  async attrs(name, attrs, buildOptions) {\n    return this.getFactory(name).attrs(attrs, buildOptions);\n  }\n\n  async build(name, attrs = {}, buildOptions = {}) {\n    const adapter = this.getAdapter(name);\n    return this.getFactory(name)\n      .build(adapter, attrs, buildOptions)\n      .then(model => (this.options.afterBuild ?\n          this.options.afterBuild(model, attrs, buildOptions) :\n          model\n      ));\n  }\n\n  async create(name, attrs, buildOptions) {\n    const adapter = this.getAdapter(name);\n    return this.getFactory(name)\n      .create(adapter, attrs, buildOptions)\n      .then(createdModel => this.addToCreatedList(adapter, createdModel))\n      .then(model => (this.options.afterCreate ?\n          this.options.afterCreate(model, attrs, buildOptions) :\n          model\n      ));\n  }\n\n  attrsMany(name, num, attrs, buildOptions) {\n    return this.getFactory(name).attrsMany(num, attrs, buildOptions);\n  }\n\n  async buildMany(name, num, attrs, buildOptions) {\n    const adapter = this.getAdapter(name);\n    return this.getFactory(name)\n      .buildMany(adapter, num, attrs, buildOptions)\n      .then(models => (this.options.afterBuild ?\n          Promise.all(models.map(\n            model => this.options.afterBuild(model, attrs, buildOptions)\n          )) :\n          models\n      ));\n  }\n\n  async createMany(name, num, attrs, buildOptions) {\n    const adapter = this.getAdapter(name);\n    return this.getFactory(name)\n      .createMany(adapter, num, attrs, buildOptions)\n      .then(models => this.addToCreatedList(adapter, models))\n      .then(models => (this.options.afterCreate ?\n          Promise.all(models.map(\n            model => this.options.afterCreate(model, attrs, buildOptions)\n          )) :\n          models\n      ));\n  }\n\n  getFactory(name, throwError = true) {\n    if (!this.factories[name] && throwError) {\n      throw new Error(`Invalid factory '${name} requested`);\n    }\n    return this.factories[name];\n  }\n\n  withOptions(options, merge = false) {\n    this.options = merge ? { ...this.options, ...options } : options;\n  }\n\n  getAdapter(factory) {\n    return factory ?\n      (this.adapters[factory] || this.defaultAdapter) :\n      this.defaultAdapter;\n  }\n\n  addToCreatedList(adapter, models) {\n    if (!Array.isArray(models)) {\n      this.created.add([adapter, models]);\n    } else {\n      for (const model of models) {\n        this.created.add([adapter, model]);\n      }\n    }\n    return models;\n  }\n\n  cleanUp() {\n    const createdArray = [];\n    for (const c of this.created) {\n      createdArray.push(c);\n    }\n    const promise = createdArray.reduce(\n      (prev, [adapter, model]) =>\n        prev.then(() => adapter.destroy(model, model.constructor)),\n      Promise.resolve()\n    );\n    this.created.clear();\n    this.resetSeq();\n    return promise;\n  }\n\n  setAdapter(adapter, factoryNames = null) {\n    if (!factoryNames) {\n      this.defaultAdapter = adapter;\n    } else {\n      factoryNames = Array.isArray(factoryNames) ? factoryNames : [factoryNames];\n      factoryNames.forEach(name => {\n        this.adapters[name] = adapter;\n      });\n    }\n    return adapter;\n  }\n}\n\nexport function generatorThunk(factoryGirl, SomeGenerator) {\n  const generator = new SomeGenerator(factoryGirl);\n  return (...args) => () => generator.generate(...args);\n}\n\nfunction deprecate(method, see) {\n  return () => {\n    throw new Error(`The ${method} method has been deprecated, use ${see} instead`);\n  };\n}\n","import DefaultAdapter from './DefaultAdapter';\n\n/* eslint-disable no-unused-vars */\nexport default class ObjectAdapter extends DefaultAdapter {\n  build(Model, props) {\n    const model = new Model;\n    this.set(props, model, Model);\n    return model;\n  }\n  async save(model, Model) {\n    return model;\n  }\n  async destroy(model, Model) {\n    return model;\n  }\n  get(model, attr, Model) {\n    return model[attr];\n  }\n  set(props, model, Model) {\n    return Object.assign(model, props);\n  }\n}\n","import DefaultAdapter from './DefaultAdapter';\n\n/* eslint-disable no-unused-vars */\nexport default class BookshelfAdapter extends DefaultAdapter {\n  save(doc, Model) {\n    return doc.save(null, { method: 'insert' });\n  }\n}\n\n","import DefaultAdapter from './DefaultAdapter';\n\n/* eslint-disable no-unused-vars */\nexport default class MongooseAdapter extends DefaultAdapter {\n  async destroy(model, Model) {\n    return model.remove();\n  }\n}\n","import DefaultAdapter from './DefaultAdapter';\n\n/* eslint-disable no-unused-vars */\nexport default class SequelizeAdapter extends DefaultAdapter {\n  build(Model, props) {\n    return Model.build(props);\n  }\n}\n","import DefaultAdapter from './DefaultAdapter';\n\n/* eslint-disable no-unused-vars */\nexport default class ReduxORMAdapter extends DefaultAdapter {\n  constructor(session) {\n    super();\n    this.session = session;\n  }\n\n  build(modelName, props) {\n    return this.session[modelName].create(props);\n  }\n\n  get(model, attr) {\n    return model[attr];\n  }\n\n  async save(model, Model) {\n    return model;\n  }\n\n  async destroy(model, Model) {\n    return Promise.resolve(model.delete()).then(() => true);\n  }\n}\n","import FactoryGirl from './FactoryGirl';\n\nexport ObjectAdapter from './adapters/ObjectAdapter';\nexport BookshelfAdapter from './adapters/BookshelfAdapter';\nexport DefaultAdapter from './adapters/DefaultAdapter';\nexport MongooseAdapter from './adapters/MongooseAdapter';\nexport SequelizeAdapter from './adapters/SequelizeAdapter';\nexport ReduxORMAdapter from './adapters/ReduxORMAdapter';\n\nconst factory = new FactoryGirl();\nfactory.FactoryGirl = FactoryGirl;\n\nexport { factory };\n\nexport default factory;\n"],"names":[],"mappings":"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"}